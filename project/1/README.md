# 第一次作业

## 计算至少连续X个等规单元组在Y个分子量上的概率
---

**首先需要注意的是, Y个unit中实际有间距为Y-1 计算中有所转换**

## 枚举算法(Brutal)

方法解释: 假设总共计算X个等规单元组, 以字符串类型定义变量triad, 以时间复杂度$O(2^{Y-1})$暴力搜索所有可能, 并比较每个可能性的二进制字符串, 如果triad字符串出现在枚举的二进制数字中, 则可判定为一种情况。最后与所有可能性$2^{Y-1}$相除得到答案

+ 如果需要测试算法, 请取消第49行的注释, 并为第52行打上注释, 在命令行运行python文件即可

## 递归算法(Recursive)

方法解释: 从链段的第一个结构单元开始依次分析, 因为总共需要X个连续的等规单元组, 那么如果前X个全是等规就已经达到目标, 之后的可能性是$2^{Y-X}$;同时, 如果前X-1个都为连续等规单元组但是第X个不是, 那么之前的都前功尽弃, 需要重新计算, 也就是整个链段长度**等效缩短**成了Y-(X-1); 以上都属于我们第一个假设, 也就是我们的第一个结构单元是我们需要的等规单元, 同时我们还有另一种可能也就是这不是我们需要的等规单元, 这个之后所有结构单元的可能性也就**等效缩短**成了Y-1。我们从这时开始就可以抛弃第一个结构单元而去考虑第二个单元了因为我们所有的可能性 = $2^{Y-X}$ + "至少连续X个等规单元组在Y-1个分子量上的可能性" + blabla 我们依次类推可以得到一个方程
$$P(X, Y) = 2^{Y-X} + \sum_{i=1}^X P(X, Y-i)$$
其中P表示至少连续X个等规单元组在Y个分子量上的所有可能性。X, Y分别为我们已知的参数。那么我们就可以根据这个公式实现递归算法

+ 如果需要测试算法, 请取消第52行的注释, 并为第49行打上注释, 在命令行运行python文件即可

## 运行结果

<img src="./1.png" />

 

